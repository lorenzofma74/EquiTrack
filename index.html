<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1, height=device-height, viewport-fit=cover, width=device-width">
    <meta name="theme-color" content="#00695c">

    <meta name="author" content="prenom.nom@etu.univ-smb.fr"/>
    <meta name="description" content="Application de gestion √©questre">

    <meta property="og:title" content="EquiTrack">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://srv-peda2.iut-acy.univ-smb.fr/flammial/EquiTrack/">
    <meta property="og:image" content="https://srv-peda2.iut-acy.univ-smb.fr/flammial/EquiTrack/favicon/og-image-1200x630.png">

    <link rel="manifest" href="/flammial/EquiTrack/favicon/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/flammial/EquiTrack/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/flammial/EquiTrack/favicon/favicon-96x96.png">

    <title>EquiTrack</title>

    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.teal-amber.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <link rel="stylesheet" href="./css/style.css">
    <script defer src="./js/pwa.js"></script>
    <script defer src="./js/app.js"></script>

    <style>
        /* --- DESIGN MODERN TEAL --- */
        body { background-color: #f0f2f5; font-family: 'Roboto', sans-serif; color: #333; }
        h1, h2, h3, h4, .mdl-layout-title { font-family: 'Poppins', sans-serif; }

        /* Header */
        .mdl-layout__header { background: #00695c; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .mdl-layout-title { font-weight: 700; letter-spacing: 1px; }

        /* Cartes Arrondies */
        .mdl-card {
            border-radius: 20px;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.1);
            border: none;
            overflow: hidden;
            margin-bottom: 20px;
            min-height: auto;
        }
        .mdl-card__title { padding: 20px 25px; }

        /* Widget M√©t√©o (Gradient) */
        .weather-card { background: linear-gradient(135deg, #26a69a 0%, #00695c 100%); color: white; }
        .weather-content {
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 25px 20px 25px;
        }
        .weather-temp { font-size: 3.5rem; font-weight: 700; line-height: 1; margin: 0; }
        .weather-desc { opacity: 0.9; font-size: 1.1rem; margin-top: 5px; font-weight: 300; }
        .weather-icon-large { font-size: 80px !important; opacity: 0.8; color: white; }
        .weather-footer { background: rgba(0,0,0,0.1); padding: 15px 25px; border:none; }
        .weather-footer a { color: white; text-decoration: none; font-weight: 500; width: 100%; display:block;}

        /* Carte Map */
        #map { height: 350px; width: 100%; z-index: 0; border-radius: 0 0 20px 20px; }
        .map-status-bar { padding: 15px 25px; background: white; display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #eee; }

        /* SOS Card */
        .sos-card { border: 2px solid #ef5350; background: #ffebee; }
        .sos-card .mdl-card__title-text { color: #d32f2f; font-weight: bold; }
        .sos-btn {
            border-radius: 50px; height: 55px; font-size: 16px; font-weight: bold;
            box-shadow: 0 8px 20px rgba(211, 47, 47, 0.3); width: 100%; background-color: #d32f2f; color: white;
        }

        /* Boutons PWA */
        .btn-pwa { border-radius: 30px; margin-bottom: 20px; }
    </style>
</head>

<body id="body-page">

  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">

    <header class="mdl-layout__header">
      <div class="mdl-layout__header-row">
        <span class="mdl-layout-title">üêé EquiTrack</span>
        <div class="mdl-layout-spacer"></div>
        
        <button id="soundButton" class="mdl-button mdl-js-button mdl-button--icon">
            <i class="material-icons">volume_up</i>
        </button>
        <audio id="clickSound" src="./son/cheval.mp3"></audio>

        <a href="formul_cheval.html" class="mdl-button mdl-js-button mdl-button--icon">
            <i class="material-icons">account_circle</i>
        </a>
      </div>
    </header>

    <main class="mdl-layout__content">
      <div class="mdl-grid" style="max-width: 1000px; margin: 0 auto; padding-top: 20px;">

        <div class="mdl-cell mdl-cell--12-col" style="text-align: center;">
             <button id="install_button" disabled class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent btn-pwa">
                <i class="material-icons">download</i> Installer l'app
             </button>

             <button id="reload_button" disabled class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored btn-pwa">
                <i class="material-icons">refresh</i> Mise √† jour dispo
             </button>
        </div>

        <div class="mdl-cell mdl-cell--5-col mdl-cell--12-col-tablet">
            <div class="mdl-card mdl-shadow--2dp weather-card" style="width: 100%">
                <div class="mdl-card__title">
                  <h2 class="mdl-card__title-text" style="font-size: 14px; opacity: 0.8; text-transform: uppercase;">M√©t√©o Locale</h2>
                </div>
                <div class="weather-content" id="weather">
                  <div>
                      <h4 class="weather-temp" id="temperature">--&deg;</h4>
                      <p id="rain" class="weather-desc">Chargement...</p>
                  </div>
                  <i class="material-icons weather-icon-large">cloud</i>
                </div>
                <div class="weather-footer">
                    <a href="meteo.html">VOIR PR√âVISIONS 72H <i class="material-icons" style="float:right">arrow_forward</i></a>
                    <p id="day-forecast" style="display:none"></p> </div>
            </div>
        </div>

        <div class="mdl-cell mdl-cell--7-col mdl-cell--12-col-tablet">
          <div class="mdl-card mdl-shadow--2dp" style="width: 100%; background: white;">
             <div class="mdl-card__title">
                <h2 class="mdl-card__title-text" style="color: #00695c;">
                    <i class="material-icons" style="margin-right: 10px; color: #26a69a;">map</i> Carte Live
                </h2>
             </div>
             
             <div style="position: relative;">
                 <div id="map"></div>
             </div>

             <div class="map-status-bar">
                <span id="status-map" style="color:#666; font-size:0.9em;">Recherche position...</span>
                <a id="map-link" href="#" class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">PARTAGER</a>
             </div>
          </div>
        </div>

        <div class="mdl-cell mdl-cell--12-col">
           <div class="mdl-card mdl-shadow--4dp sos-card" style="width: 100%;">
              <div class="mdl-card__title">
                 <h2 class="mdl-card__title-text">
                    <i class="material-icons" style="margin-right: 10px;">warning</i> SOS CHUTE
                 </h2>
              </div>

              <div class="mdl-card__supporting-text" style="padding: 0 25px 20px 25px;">
                 <p style="color: #d32f2f;">Entrez le num√©ro √† contacter en cas de chute.</p>

                 <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" style="width: 100%;">
                    <input class="mdl-textfield__input" type="tel" id="tel-urgence">
                    <label class="mdl-textfield__label" for="tel-urgence" style="color: #d32f2f;">Num√©ro d'urgence</label>
                 </div>

                 <div style="display:flex; justify-content:space-between; margin-top:10px;">
                     <p id="debug-force" style="font-size:0.8em; color:#ef9a9a;">Force: 0 G</p>
                     <p id="status-sos" style="font-weight:bold; color:#c62828;">EN ATTENTE</p>
                 </div>
              </div>

              <div class="mdl-card__actions mdl-card--border" style="padding:20px; border-top: 1px solid rgba(211,47,47,0.1);">
                 <button id="btn-start" class="mdl-button mdl-js-button mdl-button--raised sos-btn">
                    ACTIVER LA D√âTECTION
                 </button>
              </div>
           </div>
        </div>

      </div>
    </main>
  </div>
</body>
</html>
